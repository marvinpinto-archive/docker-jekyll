box: wercker-labs/docker
no-response-timeout: 20
build:
  steps:
    - script:
        name: 'Print out the docker version'
        code: |
          sudo docker -v

  steps:
    - script:
        name: 'Build the docker image'
        code: |
          sudo docker build --no-cache --rm -t marvin/jekyll .

  after-steps:
    - wouter/irc-notify:
        server: irc.freenode.net
        port: 6667
        nickname: wercker
        channel: $IRC_CHANNEL

deploy:
  steps:
    - jakubriedl/docker-push:
        image: marvin/jekyll
        email: $DOCKERHUB_EMAIL
        password: $DOCKERHUB_PASSWORD
        username: $DOCKERHUB_USERNAME

  after-steps:
    - wouter/irc-notify:
        server: irc.freenode.net
        port: 6667
        nickname: wercker
        channel: $IRC_CHANNEL

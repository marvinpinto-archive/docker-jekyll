box: wercker-labs/docker
build:
  steps:
    - script:
        name: 'Print out the docker version'
        code: |
          sudo docker -v

  steps:
    - script:
        name: 'Build the docker image'
        code: |
          sudo docker build --no-cache --rm -t marvin/jekyll .

  after-steps:
    - wouter/irc-notify:
        server: irc.freenode.net
        port: 6667
        nickname: wercker
        channel: $IRC_CHANNEL

deploy:
  steps:
    - internal/docker-push:
        username: $DOCKERHUB_USERNAME
        password: $DOCKERHUB_PASSWORD
        tag: latest
        repository: marvin/jekyll
        registry: https://registry.hub.docker.com

  after-steps:
    - wouter/irc-notify:
        server: irc.freenode.net
        port: 6667
        nickname: wercker
        channel: $IRC_CHANNEL
